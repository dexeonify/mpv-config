# OSC
osc=no
osd-bar=no
osd-font=Manrope TabNum
osd-font-size=30
osd-color="#C0FFFFFF"

# Player
title-bar=no
keep-open=yes
snap-window=yes
autofit-larger=85%x85%
save-position-on-quit=yes
reset-on-next-file=speed,volume

# Video
vo=gpu-next
hwdec=auto-safe
pause=yes
glsl-shaders="~~/shaders/FSR.glsl"
demuxer-max-bytes=300MiB
demuxer-max-back-bytes=100MiB

# Deband
## Debanding settings are divided into 3 modes: light, medium & heavy.
##   Light: 1:48:16:5  |  Medium: 2:64:16:16  |  Heavy: 3:96:16:32
## Light mode is used by default.
## You can cycle through the deband modes with shift+b (see input.conf).
deband-iterations=1    # Higher: Reduce more banding but more GPU usage; >4 is redundant [Default: 1, <1..16>]
deband-threshold=48    # Higher: Increase debanding strength [Default: 48, <0..4096>]
deband-range=16        # Higher: Find more gradients; Lower: Smooth more aggressively [Default: 16, <1..64>]
deband-grain=5         # Higher: Add more noise to cover up banding [Default: 32, <0..4096>]

# Audio
volume=60
mute=yes
audio-file-auto=fuzzy

# Subs
sub-font=Manrope SemiBold
sub-font-size=40
sub-auto=fuzzy

# Screenshots
## %X is the fallback path if the video is not on the filesystem, like YouTube streams.
## The template is basically: "Video Name [HH.MM.SS.MS] (%n).png"
screenshot-template="%X{~~desktop/}%F [%wH.%wM.%wS.%wT] (%#01n)"
screenshot-format=png
screenshot-png-compression=5

# Terminal
msg-color=yes
msg-module=yes
term-osd-bar=yes
term-osd-bar-chars= [-| ]

# Internal scripts
script-opts-append=console-font=Cascadia Code
script-opts-append=console-font_size=20
script-opts-append=console-border_size=1.5
script-opts-append=stats-font=Manrope TabNum
script-opts-append=stats-font_mono=Cascadia Code
script-opts-append=stats-show_frame_info=yes
script-opts-append=ytdl_hook-try_ytdl_first=yes
script-opts-append=ytdl_hook-exclude="%.mp4$|%.webm$|%.mkv$|%.m3u8?$"

# Conditional Auto-profiles
[smooth-osc]
profile-desc=Enable smoother OSC rendering for low framerate videos
profile-cond=container_fps <= 30
video-sync=display-resample

[fix-judder]
profile-desc=Fix frame judder when rendering is too slow
profile-cond=vo_delayed_frame_count > 20 and estimated_display_fps < 35
video-sync=audio

[delete-resume-data]
profile-desc=Do not save watch later config on EOF
profile-cond=eof_reached
profile-restore=copy-equal
save-position-on-quit=no

[background-throttling]
profile-desc=Disable GPU-intensive options when unfocused
profile-cond=not focused and not pause
profile-restore=copy
profile=fast
glsl-shaders=""
deband=no
dscale=hermite
correct-downscaling=yes

[transient-files]
profile-desc=Avoid saving playback progress and logged as recent for temporary files
profile-cond=(function() local ignored, path = {"Downloads", "Temp"}, get("path", "") path = ((path:find("^%a[%w.+-]-://") or path:find("^%a[%w.+-]-:%?")) and path:lower() or require "mp.utils".join_path(get("working-directory", ""), path)):sub(1, -get("filename", ""):len()-1):lower() for _, ig in ipairs(ignored) do if path:find(ig:lower(), 1, true) then return true end end end)()
profile-restore=copy-equal
script-opts-append=memo-enabled=no
save-position-on-quit=no

# Runtime Profiles
[mid]
profile-restore=copy
profile=fast

[anime4k-mode-a]
profile-desc=Restore -> 2x Upscale
glsl-shaders-set="~~/shaders/Anime4K/Clamp_Highlights.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Restore_CNN_M.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_CNN_x2_M.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x2.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x4.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_CNN_x2_S.glsl"

[anime4k-mode-b]
profile-desc=Restore_Soft -> 2x Upscale
glsl-shaders-set="~~/shaders/Anime4K/Clamp_Highlights.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Restore_CNN_Soft_M.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_CNN_x2_M.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x2.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x4.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_CNN_x2_S.glsl"

[anime4k-mode-c]
profile-desc=Upscale_Denoise -> Restore -> Upscale
glsl-shaders-set="~~/shaders/Anime4K/Clamp_Highlights.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_Denoise_CNN_x2_S.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x2.glsl"
glsl-shaders-append="~~/shaders/Anime4K/AutoDownscalePre_x4.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Restore_CNN_S.glsl"
glsl-shaders-append="~~/shaders/Anime4K/Upscale_CNN_x2_S.glsl"

[skipsilence-default]
profile-desc=A slightly modified version of skipsilence defaults
script-opts-append=skipsilence-ramp_constant=1.25
script-opts-append=skipsilence-ramp_factor=1.2
script-opts-append=skipsilence-ramp_exponent=1.2
script-opts-append=skipsilence-speed_max=4
script-opts-append=skipsilence-threshold_duration=0.1
script-opts-append=skipsilence-arnndn_enable=yes

[skipsilence-extreme]
profile-desc=Very aggressive skipping of silence, can make it hard to listen
script-opts-append=skipsilence-ramp_constant=2
script-opts-append=skipsilence-ramp_factor=6
script-opts-append=skipsilence-ramp_exponent=1.4
script-opts-append=skipsilence-speed_max=6
script-opts-append=skipsilence-threshold_duration=0.05
script-opts-append=skipsilence-arnndn_enable=no
